"use strict";$(document).ready(function(){function e(t,e){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(e||void 0===e?"<br />":"<br>")+"$2")}$(document).on("click",".dropdown-menu",function(t){var e=location.href.split("?article=");if($targetarea=$(t.target).parent().parent().parent().parent(),$(t.target).hasClass("editing"))$targetarea.hasClass("article__area")?($title=$targetarea.children().eq(1).text(),$content=$targetarea.children().eq(2).text(),$num=e[1],$targetarea.children().eq(-1).remove(),$targetarea.children().eq(-1).remove(),$targetarea.append("\n\t\t\t\t\t<form class='create__article__editing' method=\"POST\" action='editing_article.php'>\n\t\t\t\t\t\t<div>修改文章 : 文章編號 "+$num+"</div>\n\t\t\t\t\t\t<input name='title' class='create__title' value='"+$title+'\' />\n\t\t\t\t\t\t<div class="dropdown">\n\t\t\t\t\t\t\t<button class="btn btn-dark dropdown-toggle createcomment" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">😄\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div class="dropdown-menu main" aria-labelledby="dropdownMenuButton">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<textarea name=\'content\' class=\'create__content\'>'+$content+"</textarea>\n\t\t\t\t\t\t<input name='num' type='hidden' value='"+$num+"' / >\n\t\t\t\t\t\t<button type='submit' class='btn btn-primary create__submitButton'>修改文章</button>\n\t\t\t\t\t\t<button type='button' class='btn btn-primary create__submitButton'>取消修改</button>\n\t\t\t\t\t</form>\n\t\t\t\t")):$targetarea.hasClass("subcomment")&&($content=$targetarea.children().eq(-1).text(),$num=$targetarea.children().eq(1).val(),$targetarea.children().eq(-1).remove(),$targetarea.append("\n\t\t\t\t\t<form method='POST' action='editing_sub.php' class='subcomment__form'>\n\t\t\t\t\t\t<textarea class='leavecomment__textarea' name='content'>"+$content+"</textarea>\n\t\t\t\t\t\t<input type='hidden' name='num' value='"+$num+"'/>\n\t\t\t\t\t\t<button type='submit' class='btn btn-primary create__submitButton'>修改留言</button>\n\t\t\t\t\t\t<button type='button' class='btn btn-primary create__submitButton'>不改了</button>\n\t\t\t\t\t</form>\n\t\t\t\t"));else if($(t.target).hasClass("deleting")){if($targetarea.hasClass("article__area"))$mainnum=e[1],confirm("確定要刪除嗎QQ?")&&$.ajax({type:"POST",url:"delete_article.php",data:{mainnum:$mainnum},success:function(){window.location=e[0],alert("刪除成功!")}});else $subnum=$targetarea.children().eq(1).val(),confirm("確定要刪除嗎QQ?")&&$.ajax({type:"POST",url:"delete_subcomment.php",data:{subnum:$subnum},success:function(){$targetarea.remove(),0==$(".subcomment").length&&$(".subcomment-list").remove()}})}}),$(document).on("click",".create__submitButton",function(t){"修改文章"==$(t.target).text()&&(t.preventDefault(),$title=$(t.target).parent().find("input[name=title]").val(),$content=$(t.target).parent().find("textarea[name=content]").val(),$num=$(t.target).parent().find("input[name=num]").val(),$.ajax({type:"POST",url:"editing_article.php",data:{title:$title,content:$content,num:$num},success:function(){$(t.target).parent().parent().append("\n\t\t\t\t\t\t<h>"+$title+"</h>\n\t\t\t\t\t\t<p>"+e($content)+"</p>\n\t\t\t\t\t"),$(t.target).parent().remove()}})),"修改留言"==$(t.target).text()&&(t.preventDefault(),$content=$(t.target).parent().find("textarea[name=content]").val(),$num=$(t.target).parent().find("input[name=num]").val(),$.ajax({type:"POST",url:"editing_sub.php",data:{content:$content,num:$num},success:function(){$(t.target).parent().parent().append("\n\t\t\t\t\t\t<p>"+$content+"</p>\n\t\t\t\t\t"),$(t.target).parent().remove()}})),"取消修改"==$(t.target).text()&&($targetelement=$(t.target).parent().parent(),$(t.target).parent().remove(),$targetelement.append("\n\t\t\t\t<h>"+$title+"</h>\n\t\t\t\t<p>"+e($content)+"</p>\n\t\t\t")),"不改了"==$(t.target).text()&&($targetelement=$(t.target).parent().parent(),$(t.target).parent().remove(),$targetelement.append("\n\t\t\t\t<p>"+e($content)+"</p>\n\t\t\t"))})});